services:
  backend:
    build:
      context: .
      dockerfile: apps/api/Dockerfile
      target: runner
    container_name: momentum-backend-prod
    restart: always
    ports:
      - "5001:5001"
    env_file:
      - ./apps/api/.env.prod
    networks:
      - momentum-prod-network

  frontend:
    build:
      context: .
      dockerfile: apps/web/Dockerfile
      target: runner
      args:
        NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://localhost:5001/api}
    container_name: momentum-frontend-prod
    restart: always
    ports:
      - "3001:3001"
    env_file:
      - ./apps/web/.env.production.local
    networks:
      - momentum-prod-network

networks:
  momentum-prod-network:
    driver: bridge
